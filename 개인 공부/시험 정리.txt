기하 셰이더
렌더링 파이프라인의 도메인 셰이더 다음 단계
도메인 셰이더를 다루지 않았으므로 일단은 정점 셰이더 다음 단계

기하 셰이더는 입력으로 주어지는 완전한 프리미티브로부터 각각 한번씩 호출되어
새로운 프리미티브 객체를 생성함
출력되는 정점의 개수는 기하 셰이더에서 지정할 수 있으며(maxvertexcount) 정적으로 정의되어야 함
기하 셰이더의 결과값은 gs_output을 통해 반환되기 때문에 기하 셰이더 자체는 void를 return함
기하 셰이더는 에지-인접성 정보가 포함된 상태로 출력

원래 깊이-스텐실 검사는 Output merger 단계에서 함.
그런데 이 과정에서, 어떤 한 점에 render될 예정인 3개의 오브젝트가 있다고 하면 이 오브젝트는 레스터라이저 단계를 거쳐 픽셀 셰이더를 지나며 조명, 텍스처 매핑 등 여러 가지 작업을 거쳐 결국 OM 단계에서 3개 중 2개의 정점은 깊이 검사를 통해 기각됨. 이는 비효율적임.
earlydepthstencil을 통해 픽셀 셰이더를 통과하기 전 레스터라이저를 통과한 오브젝트에 대해 깊이-스텐실 검사를 실시할 수 있음.
레스터라이저를 거쳐야 depth 정보가 생성되기 때문에 적어도 레스터라이저는 통과해야함.

스트림 출력 단계에서는 인접성 정보가 제거됨.

OM 단계에서 깊이 검사와 스텐실 검사 실시
깊이 검사와 스텐실 검사가 모두 통과해야 스텐실 버퍼가 갱신
스텐실 검사가 비활성화되었을 경우 스텐실 검사는 항상 성공하므로 스텐실 버퍼 갱신

깊이 검사가 활성화되어 있으면 깊이 검사를 실시한다. 활성화되어있지 않다면 항상 통과한다.
실패한다면 깊이 검사를 종료한다. 성공한다면 깊이 쓰기 매스크가 활성화되어있는지 확인한다. 활성화되어있지 않다면 깊이 검사를 종료한다.
활성화되어있다면 스텐실 검사 결과를 확인한다. 스텐실 검사가 활성화되어있지 않다면 항상 성공하고, 활성화되어있다면 스텐실 검사 참조값을 비교하여 통과 여부를 결정한다.
성공했다면 깊이 쓰기 매스크에 깊이값을 저장한다.
한편 스텐실 검사가 활성화되어있지 않다면 그냥 성공을 리턴하고 종료하고, 활성화되어있다면 성공/실패 여부에 따라 스텐실 쓰기 매스크의 값을 적절한 값으로 갱신한다.